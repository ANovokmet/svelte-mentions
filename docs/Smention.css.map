{
  "version": 3,
  "file": "Smention.css",
  "sources": [
    "..\\src\\SMention.html"
  ],
  "sourcesContent": [
    "<textarea class=\"text-input\" \n\ton:keydown=\"preventArrowKeys(event)\"\n\ton:keyup=\"updateValue(this.value, event)\"\n\ton:click=\"updateValue(this.value, event)\"\n\tref:input></textarea>\n<div class=\"dropdown\" class:hidden=\"!dropdownOpened\">\n\t<ul class=\"items\">\n\t\t{#each matches as match}\n\t\t\t<li class=\"{activeConfig.itemClass}\" class:selected=\"selected===match\" on:click=\"enterSelection(match)\">\n\t\t\t\t{@html activeConfig.template(match, query)}\n\t\t\t</li>\n\t\t{/each}\n\t</ul>\n\t<div class=\"results\">\n\t\tShowing {matches.length} results.\n\t</div>\n</div>\n{inputValue}\n\n<script>\n\tconst KEY_CODE = {\n\t\tup: 38,\n\t\tdown: 40,\n\t\tenter: 13\n\t}\n\n\texport default {\n\t\toncreate(){\n\t\t\tconst { inputValue } = this.get();\n\t\t\tthis.refs.input.value = inputValue;\n\t\t},\n\t\tmethods: {\n\t\t\tpreventArrowKeys(event){\n\t\t\t\tconst {dropdownOpened} = this.get();\n\t\t\t\tif(dropdownOpened && event.which === KEY_CODE.up){\n\t\t\t\t\tthis.moveSelectionUp();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\telse if(dropdownOpened && event.which === KEY_CODE.down){ \n\t\t\t\t\tthis.moveSelectionDown();\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\telse if(dropdownOpened && event.which === KEY_CODE.enter){\n\t\t\t\t\tconst {selected} = this.get();\n\t\t\t\t\tthis.enterSelection(selected);\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdateValue(value, event) {\n\t\t\t\tconst inputValue = value;\n\t\t\t\tthis.set({inputValue});\n\n\t\t\t\tconst { dropdownOpened } = this.get();\n\t\t\t\t//block arrowkeys from updating input\n\t\t\t\tif(dropdownOpened && (event.which === 38 || event.which === 40 || event.which === 13)){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst cursorPosition = this.refs.input.selectionStart;\n\t\t\t\tconst inputToCursor = inputValue.slice(0, cursorPosition);\n\t\t\t\tconsole.log('input to c', inputToCursor);\n\n\t\t\t\tconst { configs } = this.get();\n\t\t\t\tlet matches = [], activeConfig = null;\n\n\t\t\t\tconfigs.forEach(config => {\n\t\t\t\t\tconst parsed = inputToCursor.match(new RegExp(config.delimiter + '[\\\\w\\\\s]+$', \"g\")); //\\p{L} for localized\n\n\t\t\t\t\tconsole.log('parsed' + config.delimiter, parsed);\n\t\t\t\t\tif(parsed){\n\t\t\t\t\t\tconst result = parsed[parsed.length-1].substring(1);//remove delimiter (1 char)\n\t\t\t\t\t\tconsole.log(result);\n\t\t\t\t\t\tthis.set({query: result});\n\t\t\t\t\t\t//todo extract\n\t\t\t\t\t\tmatches = config.filter(config.options, result);\n\t\t\t\t\t\t//matches.forEach(m => m.html = this.getHtml(m.name, result));\n\t\t\t\t\t\tactiveConfig = config;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(matches.length > 0){\n\t\t\t\t\tthis.set({dropdownOpened: true, selected: matches[0], activeConfig});\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.set({dropdownOpened: false, selected: null});\n\t\t\t\t}\n\n\t\t\t\tthis.set({matches});\n\t\t\t},\n\t\t\tmoveSelectionDown() {\n\t\t\t\tconst {selected, matches} = this.get();\n\t\t\t\tconst index = matches.indexOf(selected);\n\t\t\t\tif(index < matches.length - 1) {\n\t\t\t\t\tthis.set({selected: matches[index + 1]});\n\t\t\t\t}\n\t\t\t},\n\t\t\tmoveSelectionUp() {\n\t\t\t\tconst {selected, matches} = this.get();\n\t\t\t\tconst index = matches.indexOf(selected);\n\t\t\t\tif(index >= 1) {\n\t\t\t\t\tthis.set({selected: matches[index - 1]});\n\t\t\t\t}\n\t\t\t},\n\t\t\tenterSelection(selected) {\n\t\t\t\tconst { activeConfig } = this.get();\n\n\t\t\t\tconst { inputValue } = this.get();\n\t\t\t\tconst cursorPosition = this.refs.input.selectionStart;\n\n\t\t\t\tconst inputToCursor = inputValue.slice(0, cursorPosition);\n\t\t\t\tconst parsed = inputToCursor.match(new RegExp(activeConfig.delimiter + '[\\\\w\\\\s]+$', \"g\")); //\\p{L} for localized\n\t\t\t\tif(parsed) {\n\t\t\t\t\tconst result = parsed[parsed.length-1];\n\t\t\t\t\t//replace last occurence\n\t\t\t\t\t//new RegExp(result + '$') + new RegExp('^' + result)\n\t\t\t\t\tconst newInput = inputToCursor.replace(new RegExp(result + '$'), activeConfig.encode(selected) + ' ') + inputValue.slice(cursorPosition, inputValue.length);\n\t\t\t\t\tthis.set({inputValue: newInput, dropdownOpened: false});\n\t\t\t\t\tthis.refs.input.value = newInput;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata() {\n\t\t\treturn { \n\t\t\t\tconfigs: [],\n\t\t\t\tinputValue: '',\n\t\t\t\tquery: '',\n\t\t\t\tmatches: [],\n\t\t\t\tactiveConfig: null,\n\t\t\t\tdropdownOpened: false,\n\t\t\t\tselected: null\n\t\t\t}\n\t\t}\n\t};\n</script>\n\n\n<style>\n\t.text-input {\n\t\twidth: 800px;\n  \t\tresize: none;\n\t}\n\n\t.dropdown {\n\t\twidth: 800px;    \n\t\tbox-sizing: border-box;\n\t\tborder: 1px solid #ccc;\n\t}\n\n\t.dropdown.hidden {\n\t\tdisplay: none;\n\t}\n\n\t.item:hover {\n\t\tbackground-color: rgba(234,234,234,1);\n\t}\n\n\t.item.selected {\n\t\tbackground-color: rgba(222,236,249,1);\n\t}\n\n\n\t.items {\n\t\tlist-style: none;\n\t\tmargin: 0;\n    \tpadding: 0;\n\t}\n\n\t.item {\n\t\tdisplay: block;\n\t\theight: 40px;\n\t}\n\n\t.image {\n\t\tvertical-align: top;\n\t\tmargin: 4px;\n\t\tfloat: left;\n\t\theight: 32px;\n    \twidth: 32px;\n    \tborder-radius: 16px;\n\t}\n\n\t.label {\n\t\tbox-sizing: border-box;\n\t\theight: 40px;\n\t\tpadding-bottom: 4px;\n    \tpadding-top: 4px;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t\tword-wrap: normal;\n\t}\n\n\t.title {\n\t\tfont-size: 12px;\n    \tline-height: 12px;\n    \tpadding-top: 3px;\n    \tpadding-bottom: 2px;\n\t}\n\n\t.subtitle {\n\t\tfont-size: 12px;\n\t\tcolor: rgba(0,0,0,.55);\n\t\tpadding-bottom: 3px;\n\t\tline-height: 12px;\n\t}\n\n\t.results {\n\t\tpadding: 4px;\n    \theight: 24px;\n\t\tcolor: rgba(0,0,0,.55);\n\t\tfont-size: 14px;\n\t\tbox-sizing: border-box;\n\t}\n</style>"
  ],
  "names": [],
  "mappings": "AAyIC,WAAW,eAAC,CAAC,AACZ,KAAK,CAAE,KAAK,CACV,MAAM,CAAE,IAAI,AACf,CAAC,AAED,SAAS,eAAC,CAAC,AACV,KAAK,CAAE,KAAK,CACZ,UAAU,CAAE,UAAU,CACtB,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,IAAI,AACvB,CAAC,AAED,SAAS,OAAO,eAAC,CAAC,AACjB,OAAO,CAAE,IAAI,AACd,CAAC,AAED,oBAAK,MAAM,AAAC,CAAC,AACZ,gBAAgB,CAAE,KAAK,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,AACtC,CAAC,AAED,KAAK,SAAS,eAAC,CAAC,AACf,gBAAgB,CAAE,KAAK,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,AACtC,CAAC,AAGD,MAAM,eAAC,CAAC,AACP,UAAU,CAAE,IAAI,CAChB,MAAM,CAAE,CAAC,CACN,OAAO,CAAE,CAAC,AACd,CAAC,AAED,KAAK,eAAC,CAAC,AACN,OAAO,CAAE,KAAK,CACd,MAAM,CAAE,IAAI,AACb,CAAC,AAED,MAAM,eAAC,CAAC,AACP,cAAc,CAAE,GAAG,CACnB,MAAM,CAAE,GAAG,CACX,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,CACT,KAAK,CAAE,IAAI,CACX,aAAa,CAAE,IAAI,AACvB,CAAC,AAED,MAAM,eAAC,CAAC,AACP,UAAU,CAAE,UAAU,CACtB,MAAM,CAAE,IAAI,CACZ,cAAc,CAAE,GAAG,CAChB,WAAW,CAAE,GAAG,CACnB,QAAQ,CAAE,MAAM,CAChB,aAAa,CAAE,QAAQ,CACvB,WAAW,CAAE,MAAM,CACnB,SAAS,CAAE,MAAM,AAClB,CAAC,AAED,MAAM,eAAC,CAAC,AACP,SAAS,CAAE,IAAI,CACZ,WAAW,CAAE,IAAI,CACjB,WAAW,CAAE,GAAG,CAChB,cAAc,CAAE,GAAG,AACvB,CAAC,AAED,SAAS,eAAC,CAAC,AACV,SAAS,CAAE,IAAI,CACf,KAAK,CAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CACtB,cAAc,CAAE,GAAG,CACnB,WAAW,CAAE,IAAI,AAClB,CAAC,AAED,QAAQ,eAAC,CAAC,AACT,OAAO,CAAE,GAAG,CACT,MAAM,CAAE,IAAI,CACf,KAAK,CAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CACtB,SAAS,CAAE,IAAI,CACf,UAAU,CAAE,UAAU,AACvB,CAAC"
}